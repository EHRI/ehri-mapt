<!DOCTYPE html>

<html lang="en">
<head>
    <title>{{ data.identity.title }}</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        body {
            display: grid;
            color: #3d3d36;
            background-color: #e2dcd5;
            font-family: Source-Serif-Pro, sans-serif;

            grid-template-areas: ". header ." ". main ." ". items ." ". footer .";
            grid-template-rows: min-content min-content auto min-content;
            grid-template-columns: 20% 1fr 20%;
            grid-gap: 1rem 0;
            margin: 0;
            padding: 0;
            height: 100vh;
        }

        h1, h2, h3, h4 {
            font-family: Barlow-Semi-Condensed, sans-serif;
        }

        a {
            color: #84024d;
            text-decoration: none;
        }

        p {
            margin: 0 0 0.5rem;
        }

        header {
            grid-area: header;
        }
        main {
            grid-area: main;
        }

        #items {
            margin: 0;
            padding: 0;
            grid-area: items;
            box-shadow: 0 2px 4px -1px rgba(0,0,0,0.2), 0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12);
        }
        #footer {
            grid-area: footer;
            padding: 1rem;
            font-size: 0.9rem;
            color: #333;
        }
        #viewer {
            position: relative;
            height: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Barlow+Semi+Condensed:600">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <script src="https://unpkg.com/mirador@latest/dist/mirador.min.js"></script>
</head>
<body>
    <header>
        <h1>{{ data.identity.title }}</h1>
    </header>

    <main>
        <article>
            <aside class="metadata">
                <address>
                    {{ data.contact.holder }}
                    <br/>
                    {{ data.contact.street }}
                    <br/>
                    {{ data.contact.postcode }}
                </address>
            </aside>

            {% if data.description.biog %}
            <h2>Biographical History</h2>
            <p class="biographical-history">
                {{ data.description.biog }}
            </p>
            {% endif %}
            {% if data.description.scope %}
            <h2>The Collection</h2>
            <p class="scope-and-content">
                {{ data.description.scope }}
            </p>
            {% endif %}
        </article>

        <section id="export">
            <h2>Download as XML</h2>
            <a href="{{ name }}.xml" target="_blank">EAD 2002</a>
        </section>

    </main>
    <section id="items">
        <div id="viewer"></div>
    </section>
    <footer id="footer">
        &copy; EHRI Project 2023
    </footer>
    <script>
      let manifest = document.location.origin + "/{{ name }}.json";

      Mirador.viewer({
        id: "viewer",
        //manifests: {
        //  manifest: {
        //    provider: "EHRI",
        //  }
        //},
        workspace: {
          type: 'mosaic',
        },
        workspaceControlPanel: {
          enabled: false
        },
        windows: [{
          manifestId: manifest,
          //view: 'gallery',
          loadedManifest: manifest,
          canvasIndex: 0,
          thumbnailNavigationPosition: 'far-bottom',
        }],
        window: {
          allowClose: false, // Prevent the user from closing this window
          allowMaximize: false,
          defaultSideBarPanel: 'info',
          sideBarOpenByDefault: true,
          views: [ // Only allow the user to select single and gallery view
            { key: 'single' },
            { key: 'gallery' },
          ]
        },
      });
    </script>
</body>
</html>